友元函数在C++中是一种特殊的函数，它允许非成员函数访问类的私有和保护成员，尽管它并不是类的成员。这种机制提供了一种突破封装的方式，有时在设计和实现某些功能时是必要的。但是，使用友元函数需要谨慎，因为它可能破坏对象的封装性和隐藏信息的安全性。


友元函数声明与定义
必须在类内部声明友元函数，但可以在类外部定义它。因此在public或private作用域里声明没有区别。
友元函数通过在类内部声明并在函数前加上friend关键字来定义。虽然声明在类内部，但友元函数的实现可以在类外部，就像普通的非成员函数一样。

友元类

在C++中，友元类（Friend Class）是一个特殊的类，它可以访问另一个类的私有（private）和保护（protected）成员。这种机制破坏了封装性，因此应当谨慎使用。通常，只有在两个类紧密耦合，且其中一个类需要直接访问另一个类的内部状态时，才考虑使用友元类。

Q：为什么引入友元，对比public有何优势？
当两个或多个类需要共享私有数据时，可以直接调用友元函数，不需要通过对象或指针。

友元类减少系统开销，提高效率，普通函数在被调用的时候，一般来说有下面几种方式：对象.+数据（或者成员函数），类名：：数据（或成员函数），而使用友元时，一个类的友元函数可以直接使用直接使用该类的数据以及成员方法，包括私有，因此来说减少了类型检查和安全性检查。所以效率更高。

Q：为什么友元函数效率更高？

友元函数在C++中能够减少类型检查和安全性检查的开销，这主要归功于友元函数的特殊访问权限。以下是几个关键点，解释了为什么友元函数会对这些检查产生影响：

直接访问权限： 友元函数被授予了直接访问类的私有和保护成员的权限。这意味着友元函数可以像访问自己的成员一样来访问这些通常被隐藏的成员。由于这种直接性，编译器在友元函数内部进行类型检查和安全性检查时，会跳过原本针对类成员的访问控制检查。

编译时确定性： 友元关系是在编译时确定的，这意味着编译器在编译阶段就知道哪些函数或类是友元。因此，编译器可以优化相关代码，减少运行时对类型和安全性的常规检查，因为这些检查在编译阶段就已经得到了验证。

信任关系： 当你将一个函数或类声明为另一个类的友元时，你实际上是在告诉编译器：“我信任这个函数或类，允许它自由地访问我的私有部分。” 基于这种信任关系，编译器会放宽对友元函数的限制，包括减少某些类型和安全性的检查。

Q：总结
谨慎使用，而且建议仅在只读场景使用，尽量减弱破坏封装性。
